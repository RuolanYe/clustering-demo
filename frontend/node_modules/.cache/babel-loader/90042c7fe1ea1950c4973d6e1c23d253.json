{"ast":null,"code":"var _jsxFileName = \"/Users/sophiaye/Desktop/mern_projects/Clustering/frontend/src/components/Dashboard.js\",\n    _s = $RefreshSig$();\n\nimport React, { useRef, useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { getImages, createImage } from '../reducers/imagesSlice';\nimport * as d3 from 'd3';\nimport { hierarchy } from 'd3-hierarchy';\nimport './bootstrap.css';\nimport legend from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction Dashboard() {\n  _s();\n\n  //get image list from redux state\n  const dispatch = useDispatch();\n  const imageList = useSelector(state => state.imagesSlice.images);\n  useEffect(() => {\n    dispatch(getImages());\n  }, [dispatch]); // data[1].children.push({name:'12314', image:'http://127.0.0.1:8000/media/post_images/Picture2.png'})\n  // imageList.map((Img) => {\n  //   data.children[Img.cluster-1].children.push({name:Img.title, image:'http://localhost:8000'+Img.image})\n  // })\n  // const dogsHierarchy = hierarchy(data).sum(()=>1)\n  // const createPack = pack().size([500,500])\n  // const dogsPack = createPack(dogsHierarchy)\n  // console.log(dogsPack)\n\n  const svgRef = useRef();\n  const data = {\n    name: 'dogs',\n    children: []\n  };\n  const classes = [];\n  classes.map(c => {\n    data.children.push({\n      name: c,\n      children: []\n    });\n  }); //d3 plots\n\n  useEffect(() => {\n    // update data \n    imageList.map(Img => {\n      // console.log(Img)\n      // console.log(classes.indexOf(Img.cluster.toString()))\n      // data.children[classes.indexOf(Img.cluster)]\n      if (classes.indexOf(Img.cluster) < 0) {\n        var class_name = Img.cluster;\n        classes.push(class_name);\n        data.children.push({\n          name: class_name,\n          children: []\n        });\n      }\n\n      data.children[classes.indexOf(Img.cluster)].children.push({\n        name: Img.title,\n        image: 'http://localhost:8000' + Img.image\n      });\n    }); // console.log(classes)\n    // console.log(data)\n\n    const width = 932;\n    const height = 932;\n\n    const pack = data => d3.pack().size([width, height]).padding(3)(d3.hierarchy(data).sum(() => 1) // .sum(d => d.value)\n    // .sort((a, b) => b.value - a.value)\n    );\n\n    const color = d3.scaleLinear().domain([0, 20]).range([\"hsl(152,80%,80%)\", \"hsl(228,30%,40%)\"]).interpolate(d3.interpolateHcl);\n    const root = pack(data); // console.log(root)\n\n    let focus = root;\n    let view;\n    const svg = d3.select(svgRef.current) // const svg = d3.create(\"svg\")\n    .attr(\"viewBox\", `-${width / 2} -${height / 2} ${width} ${height}`).style(\"display\", \"block\").style(\"margin\", \"0 -14px\").style(\"background\", \"white\").style(\"cursor\", \"pointer\").on(\"click\", event => zoom(event, root)); //refresh\n\n    svg.selectAll(\"*\").remove();\n    var defs = svg.append(\"defs\");\n    defs.append(\"pattern\").attr(\"id\", \"test-image\").attr(\"height\", \"100%\").attr(\"width\", \"100%\").attr(\"patternContentUnits\", \"objectBoundingBox\").append(\"image\").attr(\"height\", 1).attr(\"width\", 1).attr(\"preserveAspectRatio\", \"none\"); // .attr(\"xlink:href\",\"http://127.0.0.1:8000/media/post_images/Picture1_ZzTRote.png\")\n\n    defs.selectAll(\".dogs-pattern\").data(root.descendants().slice(1)).enter().append(\"pattern\").attr(\"class\", \"dogs-pattern\").attr(\"id\", d => d.data.name).attr(\"height\", \"100%\").attr(\"width\", \"100%\").attr(\"patternContentUnits\", \"objectBoundingBox\").append(\"image\").attr(\"height\", 1).attr(\"width\", 1).attr(\"preserveAspectRatio\", \"none\").attr(\"xlink:href\", d => d.data.image);\n    const node = svg.append(\"g\").selectAll(\"circle\").data(root.descendants().slice(1)).join(\"circle\") // .attr(\"fill\", d => d.children ? color(d.depth) : \"url(#\"+d.data.name+\")\")\n    .attr(\"fill\", d => d.children ? color(classes.indexOf(d.data.name)) : \"url(#\" + d.data.name + \")\").attr(\"pointer-events\", d => !d.children ? \"none\" : null).on(\"mouseover\", function () {\n      d3.select(this).attr(\"stroke\", \"#000\");\n    }).on(\"mouseout\", function () {\n      d3.select(this).attr(\"stroke\", null);\n    }).on(\"click\", (event, d) => focus !== d && (zoom(event, d), event.stopPropagation()));\n    const label = svg.append(\"g\").style(\"font\", \"20px sans-serif\").attr(\"pointer-events\", \"none\").attr(\"text-anchor\", \"middle\").selectAll(\"text\").data(root.descendants()).join(\"text\").style(\"fill-opacity\", d => d.parent === root ? 1 : 0).style(\"display\", d => d.parent === root ? \"inline\" : \"none\").text(d => {\n      // console.log(d)\n      return d.data.name;\n    });\n    zoomTo([root.x, root.y, root.r * 2]);\n\n    function zoomTo(v) {\n      const k = width / v[2];\n      view = v; // console.log(v)\n\n      label.attr(\"transform\", d => `translate(${(d.x - v[0]) * k},${(d.y - v[1]) * k})`);\n      node.attr(\"transform\", d => `translate(${(d.x - v[0]) * k},${(d.y - v[1]) * k})`);\n      node.attr(\"r\", d => d.r * k);\n    }\n\n    function zoom(event, d) {\n      // const focus0 = focus;\n      focus = d;\n      const transition = svg.transition().duration(event.altKey ? 7500 : 750).tween(\"zoom\", d => {\n        const i = d3.interpolateZoom(view, [focus.x, focus.y, focus.r * 2]);\n        return t => zoomTo(i(t));\n      });\n      label.filter(function (d) {\n        return d.parent === focus || this.style.display === \"inline\";\n      }).transition(transition).style(\"fill-opacity\", d => d.parent === focus ? 1 : 0).on(\"start\", function (d) {\n        if (d.parent === focus) this.style.display = \"inline\";\n      }).on(\"end\", function (d) {\n        if (d.parent !== focus) this.style.display = \"none\";\n      });\n    }\n  }, [imageList]); //create state to store data from input form\n\n  const [state, setState] = useState({\n    title: '',\n    image: null\n  });\n\n  const handleChange = e => {\n    setState({ ...state,\n      [e.target.id]: e.target.value\n    });\n  };\n\n  const handleImageChange = e => {\n    setState({ ...state,\n      image: e.target.files[0]\n    });\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault(); // console.log(state);\n\n    let form_data = new FormData();\n    form_data.append('image', state.image, state.image.name);\n    form_data.append('title', state.title); // let url = 'http://localhost:8000/api/images/';\n    // axios.post(url, form_data, {\n    //   headers: {\n    //     'content-type': 'multipart/form-data'\n    //   }\n    // })\n    //     .then(res => {\n    //       console.log(res.data);\n    //     })\n    //     .catch(err => console.log(err))\n\n    dispatch(createImage(form_data));\n    setState({\n      title: ''\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Dogs Classification Demo\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card border-primary mb-3\",\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        children: /*#__PURE__*/_jsxDEV(\"fieldset\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"card-header\",\n            children: \"Upload Image\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 235,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"form-label mt-4\",\n              children: \"Image name\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 237,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"form-control\",\n              type: \"text\",\n              placeholder: \"Enter image name\",\n              id: \"title\",\n              value: state.title,\n              onChange: handleChange,\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 238,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 236,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"form-label mt-4\",\n              children: \"Choose image\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 241,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"form-control\",\n              type: \"file\",\n              id: \"image\",\n              accept: \"image/png, image/jpeg\",\n              onChange: handleImageChange,\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 242,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 240,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 248,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              className: \"btn btn-primary\",\n              children: \"Upload\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 249,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 247,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      display: \"flex\",\n      \"align-items\": \"center\",\n      \"justify-content\": \"center\",\n      children: /*#__PURE__*/_jsxDEV(\"svg\", {\n        ref: svgRef,\n        height: \"auto\",\n        width: \"auto\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n}\n\n_s(Dashboard, \"+RFoyIsWWZ4+22K87lnPK20C+Mw=\", false, function () {\n  return [useDispatch, useSelector];\n});\n\n_c = Dashboard;\nexport default Dashboard;\n\nvar _c;\n\n$RefreshReg$(_c, \"Dashboard\");","map":{"version":3,"names":["React","useRef","useEffect","useState","axios","useSelector","useDispatch","getImages","createImage","d3","hierarchy","legend","Dashboard","dispatch","imageList","state","imagesSlice","images","svgRef","data","name","children","classes","map","c","push","Img","indexOf","cluster","class_name","title","image","width","height","pack","size","padding","sum","color","scaleLinear","domain","range","interpolate","interpolateHcl","root","focus","view","svg","select","current","attr","style","on","event","zoom","selectAll","remove","defs","append","descendants","slice","enter","d","node","join","stopPropagation","label","parent","text","zoomTo","x","y","r","v","k","transition","duration","altKey","tween","i","interpolateZoom","t","filter","display","setState","handleChange","e","target","id","value","handleImageChange","files","handleSubmit","preventDefault","form_data","FormData"],"sources":["/Users/sophiaye/Desktop/mern_projects/Clustering/frontend/src/components/Dashboard.js"],"sourcesContent":["import React ,{ useRef, useEffect, useState } from 'react'\nimport axios from 'axios'\nimport {useSelector, useDispatch} from 'react-redux'\nimport { getImages, createImage } from '../reducers/imagesSlice';\nimport * as d3 from 'd3'\nimport {hierarchy} from 'd3-hierarchy'\nimport './bootstrap.css'\nimport legend from 'react'\n\nfunction Dashboard() {\n  //get image list from redux state\n    const dispatch = useDispatch()\n    const imageList = useSelector((state) => state.imagesSlice.images)\n    \n    useEffect(() => {\n\n      dispatch(getImages())\n\n    }, [dispatch])\n\n \n    \n\n    // data[1].children.push({name:'12314', image:'http://127.0.0.1:8000/media/post_images/Picture2.png'})\n    // imageList.map((Img) => {\n    //   data.children[Img.cluster-1].children.push({name:Img.title, image:'http://localhost:8000'+Img.image})\n    // })\n\n    // const dogsHierarchy = hierarchy(data).sum(()=>1)\n    // const createPack = pack().size([500,500])\n    // const dogsPack = createPack(dogsHierarchy)\n    // console.log(dogsPack)\n    \n    const svgRef=useRef()\n    const data={name:'dogs',children:[]}\n    const classes = []\n\n    classes.map((c)=>{\n      data.children.push({name:c,children:[]})\n    })\n\n     //d3 plots\n    useEffect(() => {\n      // update data \n      imageList.map((Img) => {\n        // console.log(Img)\n        // console.log(classes.indexOf(Img.cluster.toString()))\n        // data.children[classes.indexOf(Img.cluster)]\n        if(classes.indexOf(Img.cluster)<0){\n          var class_name=Img.cluster\n          classes.push(class_name)\n          data.children.push({name:class_name,children:[]})\n        }\n        data.children[classes.indexOf(Img.cluster)].children.push({name:Img.title, image:'http://localhost:8000'+Img.image})\n        \n      })\n      // console.log(classes)\n      // console.log(data)\n\n      const width = 932;\n      const height = 932;\n      const pack = data => d3.pack()\n        .size([width, height])\n        .padding(3)\n        (d3.hierarchy(data)\n          .sum(()=>1)\n          // .sum(d => d.value)\n          // .sort((a, b) => b.value - a.value)\n          )\n      \n      const color = d3.scaleLinear()\n          .domain([0, 20])\n          .range([\"hsl(152,80%,80%)\", \"hsl(228,30%,40%)\"])\n          .interpolate(d3.interpolateHcl)\n\n      const root = pack(data);\n      // console.log(root)\n      let focus = root;\n      let view;\n      \n\n      const svg=d3.select(svgRef.current)\n      // const svg = d3.create(\"svg\")\n        .attr(\"viewBox\", `-${width / 2} -${height / 2} ${width} ${height}`)\n        .style(\"display\", \"block\")\n        .style(\"margin\", \"0 -14px\")\n        .style(\"background\", \"white\")\n        .style(\"cursor\", \"pointer\")\n        .on(\"click\", (event) => zoom(event, root));\n      \n      //refresh\n      svg.selectAll(\"*\").remove();\n      \n      var defs = svg.append(\"defs\")\n      defs.append(\"pattern\")\n        .attr(\"id\",\"test-image\")\n        .attr(\"height\",\"100%\")\n        .attr(\"width\",\"100%\")\n        .attr(\"patternContentUnits\",\"objectBoundingBox\")\n        .append(\"image\")\n        .attr(\"height\",1)\n        .attr(\"width\",1)\n        .attr(\"preserveAspectRatio\",\"none\")\n        // .attr(\"xlink:href\",\"http://127.0.0.1:8000/media/post_images/Picture1_ZzTRote.png\")\n\n        defs.selectAll(\".dogs-pattern\")\n        .data(root.descendants().slice(1))\n        .enter().append(\"pattern\")\n        .attr(\"class\",\"dogs-pattern\")\n        .attr(\"id\",d =>d.data.name)\n        .attr(\"height\",\"100%\")\n        .attr(\"width\",\"100%\")\n        .attr(\"patternContentUnits\",\"objectBoundingBox\")\n        .append(\"image\")\n        .attr(\"height\",1)\n        .attr(\"width\",1)\n        .attr(\"preserveAspectRatio\",\"none\")\n        .attr(\"xlink:href\",d => d.data.image)\n      \n\n      const node = svg.append(\"g\")\n        .selectAll(\"circle\")\n        .data(root.descendants().slice(1))\n        .join(\"circle\")\n          // .attr(\"fill\", d => d.children ? color(d.depth) : \"url(#\"+d.data.name+\")\")\n          .attr(\"fill\", d => d.children ? color(classes.indexOf(d.data.name)) : \"url(#\"+d.data.name+\")\")\n          .attr(\"pointer-events\", d => !d.children ? \"none\" : null)\n          .on(\"mouseover\", function() { d3.select(this).attr(\"stroke\", \"#000\"); })\n          .on(\"mouseout\", function() { d3.select(this).attr(\"stroke\", null); })\n          .on(\"click\", (event, d) => focus !== d && (zoom(event, d), event.stopPropagation()));\n\n      \n\n      const label = svg.append(\"g\")\n          .style(\"font\", \"20px sans-serif\")\n          .attr(\"pointer-events\", \"none\")\n          .attr(\"text-anchor\", \"middle\")\n        .selectAll(\"text\")\n        .data(root.descendants())\n        .join(\"text\")\n          .style(\"fill-opacity\", d => d.parent === root ? 1 : 0)\n          .style(\"display\", d => d.parent === root ? \"inline\" : \"none\")\n          .text((d) => {\n            // console.log(d)\n            return d.data.name\n          });\n          \n      zoomTo([root.x, root.y, root.r * 2]);\n      \n      function zoomTo(v) {\n        const k = width / v[2];\n    \n        view = v;\n\n        // console.log(v)\n    \n        label.attr(\"transform\", d => `translate(${(d.x - v[0]) * k},${(d.y - v[1]) * k})`);\n        node.attr(\"transform\", d => `translate(${(d.x - v[0]) * k},${(d.y - v[1]) * k})`);\n        node.attr(\"r\", d => d.r * k);\n      }\n\n      function zoom(event, d) {\n        // const focus0 = focus;\n    \n        focus = d;\n    \n        const transition = svg.transition()\n            .duration(event.altKey ? 7500 : 750)\n            .tween(\"zoom\", d => {\n              const i = d3.interpolateZoom(view, [focus.x, focus.y, focus.r * 2]);\n              return t => zoomTo(i(t));\n            });\n    \n        label\n          .filter(function(d) { return d.parent === focus || this.style.display === \"inline\"; })\n          .transition(transition)\n            .style(\"fill-opacity\", d => d.parent === focus ? 1 : 0)\n            .on(\"start\", function(d) { if (d.parent === focus) this.style.display = \"inline\"; })\n            .on(\"end\", function(d) { if (d.parent !== focus) this.style.display = \"none\"; });\n      }\n      \n    }, [imageList])\n\n\n\n    //create state to store data from input form\n    const [state, setState] = useState({\n        title: '',\n        image: null\n    });\n\n    const handleChange = (e) => {\n        setState({\n            ...state,\n            [e.target.id]: e.target.value\n        })\n      };\n    \n    const handleImageChange = (e) => {\n        setState({\n            ...state,\n            image: e.target.files[0]\n        })\n      };\n    \n    const handleSubmit = (e) => {\n        e.preventDefault();\n        // console.log(state);\n        let form_data = new FormData();\n        form_data.append('image', state.image, state.image.name);\n        form_data.append('title', state.title);\n        // let url = 'http://localhost:8000/api/images/';\n        // axios.post(url, form_data, {\n        //   headers: {\n        //     'content-type': 'multipart/form-data'\n        //   }\n        // })\n        //     .then(res => {\n        //       console.log(res.data);\n        //     })\n        //     .catch(err => console.log(err))\n      \n        dispatch(createImage(form_data))\n        setState({title: ''});\n      };\n\n\n  return (<>\n    {/* <div className=\"card\"> */}\n      <h1>Dogs Classification Demo</h1>\n      <br/>\n      <div className=\"card border-primary mb-3\">\n        <form onSubmit={handleSubmit}>\n          <fieldset>\n            <div className=\"card-header\">Upload Image</div>\n            <div className=\"form-group\">\n              <label className=\"form-label mt-4\">Image name</label>\n              <input className=\"form-control\" type=\"text\" placeholder='Enter image name' id='title' value={state.title} onChange={handleChange} required/>\n            </div>\n            <div className=\"form-group\">\n              <label className=\"form-label mt-4\">Choose image</label>\n                <input className=\"form-control\"\n                      type=\"file\"\n                      id=\"image\"\n                      accept=\"image/png, image/jpeg\"  onChange={handleImageChange} required/>\n            </div>\n            <div className=\"form-group\">\n              <br/>\n              <button type=\"submit\" className=\"btn btn-primary\">Upload</button>\n            </div>\n          </fieldset>\n        </form> \n      </div>\n    {/* </div> */}\n        <div display=\"flex\" align-items=\"center\" justify-content=\"center\">\n        {/* <container display=\"flex\" justify-content=\"center\" > */}\n          <svg ref={svgRef} height=\"auto\" width=\"auto\"></svg>\n        {/* </container> */}\n        </div>\n        {/* <svg/> */}\n    \n    </>\n  )\n}\n\nexport default Dashboard"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,MAAhB,EAAwBC,SAAxB,EAAmCC,QAAnC,QAAmD,OAAnD;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAAQC,WAAR,EAAqBC,WAArB,QAAuC,aAAvC;AACA,SAASC,SAAT,EAAoBC,WAApB,QAAuC,yBAAvC;AACA,OAAO,KAAKC,EAAZ,MAAoB,IAApB;AACA,SAAQC,SAAR,QAAwB,cAAxB;AACA,OAAO,iBAAP;AACA,OAAOC,MAAP,MAAmB,OAAnB;;;;AAEA,SAASC,SAAT,GAAqB;EAAA;;EACnB;EACE,MAAMC,QAAQ,GAAGP,WAAW,EAA5B;EACA,MAAMQ,SAAS,GAAGT,WAAW,CAAEU,KAAD,IAAWA,KAAK,CAACC,WAAN,CAAkBC,MAA9B,CAA7B;EAEAf,SAAS,CAAC,MAAM;IAEdW,QAAQ,CAACN,SAAS,EAAV,CAAR;EAED,CAJQ,EAIN,CAACM,QAAD,CAJM,CAAT,CALiB,CAcjB;EACA;EACA;EACA;EAEA;EACA;EACA;EACA;;EAEA,MAAMK,MAAM,GAACjB,MAAM,EAAnB;EACA,MAAMkB,IAAI,GAAC;IAACC,IAAI,EAAC,MAAN;IAAaC,QAAQ,EAAC;EAAtB,CAAX;EACA,MAAMC,OAAO,GAAG,EAAhB;EAEAA,OAAO,CAACC,GAAR,CAAaC,CAAD,IAAK;IACfL,IAAI,CAACE,QAAL,CAAcI,IAAd,CAAmB;MAACL,IAAI,EAACI,CAAN;MAAQH,QAAQ,EAAC;IAAjB,CAAnB;EACD,CAFD,EA5BiB,CAgChB;;EACDnB,SAAS,CAAC,MAAM;IACd;IACAY,SAAS,CAACS,GAAV,CAAeG,GAAD,IAAS;MACrB;MACA;MACA;MACA,IAAGJ,OAAO,CAACK,OAAR,CAAgBD,GAAG,CAACE,OAApB,IAA6B,CAAhC,EAAkC;QAChC,IAAIC,UAAU,GAACH,GAAG,CAACE,OAAnB;QACAN,OAAO,CAACG,IAAR,CAAaI,UAAb;QACAV,IAAI,CAACE,QAAL,CAAcI,IAAd,CAAmB;UAACL,IAAI,EAACS,UAAN;UAAiBR,QAAQ,EAAC;QAA1B,CAAnB;MACD;;MACDF,IAAI,CAACE,QAAL,CAAcC,OAAO,CAACK,OAAR,CAAgBD,GAAG,CAACE,OAApB,CAAd,EAA4CP,QAA5C,CAAqDI,IAArD,CAA0D;QAACL,IAAI,EAACM,GAAG,CAACI,KAAV;QAAiBC,KAAK,EAAC,0BAAwBL,GAAG,CAACK;MAAnD,CAA1D;IAED,CAXD,EAFc,CAcd;IACA;;IAEA,MAAMC,KAAK,GAAG,GAAd;IACA,MAAMC,MAAM,GAAG,GAAf;;IACA,MAAMC,IAAI,GAAGf,IAAI,IAAIV,EAAE,CAACyB,IAAH,GAClBC,IADkB,CACb,CAACH,KAAD,EAAQC,MAAR,CADa,EAElBG,OAFkB,CAEV,CAFU,EAGlB3B,EAAE,CAACC,SAAH,CAAaS,IAAb,EACEkB,GADF,CACM,MAAI,CADV,CAHkB,CAKjB;IACA;IANiB,CAArB;;IASA,MAAMC,KAAK,GAAG7B,EAAE,CAAC8B,WAAH,GACTC,MADS,CACF,CAAC,CAAD,EAAI,EAAJ,CADE,EAETC,KAFS,CAEH,CAAC,kBAAD,EAAqB,kBAArB,CAFG,EAGTC,WAHS,CAGGjC,EAAE,CAACkC,cAHN,CAAd;IAKA,MAAMC,IAAI,GAAGV,IAAI,CAACf,IAAD,CAAjB,CAjCc,CAkCd;;IACA,IAAI0B,KAAK,GAAGD,IAAZ;IACA,IAAIE,IAAJ;IAGA,MAAMC,GAAG,GAACtC,EAAE,CAACuC,MAAH,CAAU9B,MAAM,CAAC+B,OAAjB,EACV;IADU,CAEPC,IAFO,CAEF,SAFE,EAEU,IAAGlB,KAAK,GAAG,CAAE,KAAIC,MAAM,GAAG,CAAE,IAAGD,KAAM,IAAGC,MAAO,EAFzD,EAGPkB,KAHO,CAGD,SAHC,EAGU,OAHV,EAIPA,KAJO,CAID,QAJC,EAIS,SAJT,EAKPA,KALO,CAKD,YALC,EAKa,OALb,EAMPA,KANO,CAMD,QANC,EAMS,SANT,EAOPC,EAPO,CAOJ,OAPI,EAOMC,KAAD,IAAWC,IAAI,CAACD,KAAD,EAAQT,IAAR,CAPpB,CAAV,CAvCc,CAgDd;;IACAG,GAAG,CAACQ,SAAJ,CAAc,GAAd,EAAmBC,MAAnB;IAEA,IAAIC,IAAI,GAAGV,GAAG,CAACW,MAAJ,CAAW,MAAX,CAAX;IACAD,IAAI,CAACC,MAAL,CAAY,SAAZ,EACGR,IADH,CACQ,IADR,EACa,YADb,EAEGA,IAFH,CAEQ,QAFR,EAEiB,MAFjB,EAGGA,IAHH,CAGQ,OAHR,EAGgB,MAHhB,EAIGA,IAJH,CAIQ,qBAJR,EAI8B,mBAJ9B,EAKGQ,MALH,CAKU,OALV,EAMGR,IANH,CAMQ,QANR,EAMiB,CANjB,EAOGA,IAPH,CAOQ,OAPR,EAOgB,CAPhB,EAQGA,IARH,CAQQ,qBARR,EAQ8B,MAR9B,EApDc,CA6DZ;;IAEAO,IAAI,CAACF,SAAL,CAAe,eAAf,EACCpC,IADD,CACMyB,IAAI,CAACe,WAAL,GAAmBC,KAAnB,CAAyB,CAAzB,CADN,EAECC,KAFD,GAESH,MAFT,CAEgB,SAFhB,EAGCR,IAHD,CAGM,OAHN,EAGc,cAHd,EAICA,IAJD,CAIM,IAJN,EAIWY,CAAC,IAAGA,CAAC,CAAC3C,IAAF,CAAOC,IAJtB,EAKC8B,IALD,CAKM,QALN,EAKe,MALf,EAMCA,IAND,CAMM,OANN,EAMc,MANd,EAOCA,IAPD,CAOM,qBAPN,EAO4B,mBAP5B,EAQCQ,MARD,CAQQ,OARR,EASCR,IATD,CASM,QATN,EASe,CATf,EAUCA,IAVD,CAUM,OAVN,EAUc,CAVd,EAWCA,IAXD,CAWM,qBAXN,EAW4B,MAX5B,EAYCA,IAZD,CAYM,YAZN,EAYmBY,CAAC,IAAIA,CAAC,CAAC3C,IAAF,CAAOY,KAZ/B;IAeF,MAAMgC,IAAI,GAAGhB,GAAG,CAACW,MAAJ,CAAW,GAAX,EACVH,SADU,CACA,QADA,EAEVpC,IAFU,CAELyB,IAAI,CAACe,WAAL,GAAmBC,KAAnB,CAAyB,CAAzB,CAFK,EAGVI,IAHU,CAGL,QAHK,EAIT;IAJS,CAKRd,IALQ,CAKH,MALG,EAKKY,CAAC,IAAIA,CAAC,CAACzC,QAAF,GAAaiB,KAAK,CAAChB,OAAO,CAACK,OAAR,CAAgBmC,CAAC,CAAC3C,IAAF,CAAOC,IAAvB,CAAD,CAAlB,GAAmD,UAAQ0C,CAAC,CAAC3C,IAAF,CAAOC,IAAf,GAAoB,GALjF,EAMR8B,IANQ,CAMH,gBANG,EAMeY,CAAC,IAAI,CAACA,CAAC,CAACzC,QAAH,GAAc,MAAd,GAAuB,IAN3C,EAOR+B,EAPQ,CAOL,WAPK,EAOQ,YAAW;MAAE3C,EAAE,CAACuC,MAAH,CAAU,IAAV,EAAgBE,IAAhB,CAAqB,QAArB,EAA+B,MAA/B;IAAyC,CAP9D,EAQRE,EARQ,CAQL,UARK,EAQO,YAAW;MAAE3C,EAAE,CAACuC,MAAH,CAAU,IAAV,EAAgBE,IAAhB,CAAqB,QAArB,EAA+B,IAA/B;IAAuC,CAR3D,EASRE,EATQ,CASL,OATK,EASI,CAACC,KAAD,EAAQS,CAAR,KAAcjB,KAAK,KAAKiB,CAAV,KAAgBR,IAAI,CAACD,KAAD,EAAQS,CAAR,CAAJ,EAAgBT,KAAK,CAACY,eAAN,EAAhC,CATlB,CAAb;IAaA,MAAMC,KAAK,GAAGnB,GAAG,CAACW,MAAJ,CAAW,GAAX,EACTP,KADS,CACH,MADG,EACK,iBADL,EAETD,IAFS,CAEJ,gBAFI,EAEc,MAFd,EAGTA,IAHS,CAGJ,aAHI,EAGW,QAHX,EAIXK,SAJW,CAID,MAJC,EAKXpC,IALW,CAKNyB,IAAI,CAACe,WAAL,EALM,EAMXK,IANW,CAMN,MANM,EAOTb,KAPS,CAOH,cAPG,EAOaW,CAAC,IAAIA,CAAC,CAACK,MAAF,KAAavB,IAAb,GAAoB,CAApB,GAAwB,CAP1C,EAQTO,KARS,CAQH,SARG,EAQQW,CAAC,IAAIA,CAAC,CAACK,MAAF,KAAavB,IAAb,GAAoB,QAApB,GAA+B,MAR5C,EASTwB,IATS,CASHN,CAAD,IAAO;MACX;MACA,OAAOA,CAAC,CAAC3C,IAAF,CAAOC,IAAd;IACD,CAZS,CAAd;IAcAiD,MAAM,CAAC,CAACzB,IAAI,CAAC0B,CAAN,EAAS1B,IAAI,CAAC2B,CAAd,EAAiB3B,IAAI,CAAC4B,CAAL,GAAS,CAA1B,CAAD,CAAN;;IAEA,SAASH,MAAT,CAAgBI,CAAhB,EAAmB;MACjB,MAAMC,CAAC,GAAG1C,KAAK,GAAGyC,CAAC,CAAC,CAAD,CAAnB;MAEA3B,IAAI,GAAG2B,CAAP,CAHiB,CAKjB;;MAEAP,KAAK,CAAChB,IAAN,CAAW,WAAX,EAAwBY,CAAC,IAAK,aAAY,CAACA,CAAC,CAACQ,CAAF,GAAMG,CAAC,CAAC,CAAD,CAAR,IAAeC,CAAE,IAAG,CAACZ,CAAC,CAACS,CAAF,GAAME,CAAC,CAAC,CAAD,CAAR,IAAeC,CAAE,GAA/E;MACAX,IAAI,CAACb,IAAL,CAAU,WAAV,EAAuBY,CAAC,IAAK,aAAY,CAACA,CAAC,CAACQ,CAAF,GAAMG,CAAC,CAAC,CAAD,CAAR,IAAeC,CAAE,IAAG,CAACZ,CAAC,CAACS,CAAF,GAAME,CAAC,CAAC,CAAD,CAAR,IAAeC,CAAE,GAA9E;MACAX,IAAI,CAACb,IAAL,CAAU,GAAV,EAAeY,CAAC,IAAIA,CAAC,CAACU,CAAF,GAAME,CAA1B;IACD;;IAED,SAASpB,IAAT,CAAcD,KAAd,EAAqBS,CAArB,EAAwB;MACtB;MAEAjB,KAAK,GAAGiB,CAAR;MAEA,MAAMa,UAAU,GAAG5B,GAAG,CAAC4B,UAAJ,GACdC,QADc,CACLvB,KAAK,CAACwB,MAAN,GAAe,IAAf,GAAsB,GADjB,EAEdC,KAFc,CAER,MAFQ,EAEAhB,CAAC,IAAI;QAClB,MAAMiB,CAAC,GAAGtE,EAAE,CAACuE,eAAH,CAAmBlC,IAAnB,EAAyB,CAACD,KAAK,CAACyB,CAAP,EAAUzB,KAAK,CAAC0B,CAAhB,EAAmB1B,KAAK,CAAC2B,CAAN,GAAU,CAA7B,CAAzB,CAAV;QACA,OAAOS,CAAC,IAAIZ,MAAM,CAACU,CAAC,CAACE,CAAD,CAAF,CAAlB;MACD,CALc,CAAnB;MAOAf,KAAK,CACFgB,MADH,CACU,UAASpB,CAAT,EAAY;QAAE,OAAOA,CAAC,CAACK,MAAF,KAAatB,KAAb,IAAsB,KAAKM,KAAL,CAAWgC,OAAX,KAAuB,QAApD;MAA+D,CADvF,EAEGR,UAFH,CAEcA,UAFd,EAGKxB,KAHL,CAGW,cAHX,EAG2BW,CAAC,IAAIA,CAAC,CAACK,MAAF,KAAatB,KAAb,GAAqB,CAArB,GAAyB,CAHzD,EAIKO,EAJL,CAIQ,OAJR,EAIiB,UAASU,CAAT,EAAY;QAAE,IAAIA,CAAC,CAACK,MAAF,KAAatB,KAAjB,EAAwB,KAAKM,KAAL,CAAWgC,OAAX,GAAqB,QAArB;MAAgC,CAJvF,EAKK/B,EALL,CAKQ,KALR,EAKe,UAASU,CAAT,EAAY;QAAE,IAAIA,CAAC,CAACK,MAAF,KAAatB,KAAjB,EAAwB,KAAKM,KAAL,CAAWgC,OAAX,GAAqB,MAArB;MAA8B,CALnF;IAMD;EAEF,CA3IQ,EA2IN,CAACrE,SAAD,CA3IM,CAAT,CAjCiB,CAgLjB;;EACA,MAAM,CAACC,KAAD,EAAQqE,QAAR,IAAoBjF,QAAQ,CAAC;IAC/B2B,KAAK,EAAE,EADwB;IAE/BC,KAAK,EAAE;EAFwB,CAAD,CAAlC;;EAKA,MAAMsD,YAAY,GAAIC,CAAD,IAAO;IACxBF,QAAQ,CAAC,EACL,GAAGrE,KADE;MAEL,CAACuE,CAAC,CAACC,MAAF,CAASC,EAAV,GAAeF,CAAC,CAACC,MAAF,CAASE;IAFnB,CAAD,CAAR;EAID,CALH;;EAOA,MAAMC,iBAAiB,GAAIJ,CAAD,IAAO;IAC7BF,QAAQ,CAAC,EACL,GAAGrE,KADE;MAELgB,KAAK,EAAEuD,CAAC,CAACC,MAAF,CAASI,KAAT,CAAe,CAAf;IAFF,CAAD,CAAR;EAID,CALH;;EAOA,MAAMC,YAAY,GAAIN,CAAD,IAAO;IACxBA,CAAC,CAACO,cAAF,GADwB,CAExB;;IACA,IAAIC,SAAS,GAAG,IAAIC,QAAJ,EAAhB;IACAD,SAAS,CAACpC,MAAV,CAAiB,OAAjB,EAA0B3C,KAAK,CAACgB,KAAhC,EAAuChB,KAAK,CAACgB,KAAN,CAAYX,IAAnD;IACA0E,SAAS,CAACpC,MAAV,CAAiB,OAAjB,EAA0B3C,KAAK,CAACe,KAAhC,EALwB,CAMxB;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;;IAEAjB,QAAQ,CAACL,WAAW,CAACsF,SAAD,CAAZ,CAAR;IACAV,QAAQ,CAAC;MAACtD,KAAK,EAAE;IAAR,CAAD,CAAR;EACD,CAnBH;;EAsBF,oBAAQ;IAAA,wBAEJ;MAAA;IAAA;MAAA;MAAA;MAAA;IAAA,QAFI,eAGJ;MAAA;MAAA;MAAA;IAAA,QAHI,eAIJ;MAAK,SAAS,EAAC,0BAAf;MAAA,uBACE;QAAM,QAAQ,EAAE8D,YAAhB;QAAA,uBACE;UAAA,wBACE;YAAK,SAAS,EAAC,aAAf;YAAA;UAAA;YAAA;YAAA;YAAA;UAAA,QADF,eAEE;YAAK,SAAS,EAAC,YAAf;YAAA,wBACE;cAAO,SAAS,EAAC,iBAAjB;cAAA;YAAA;cAAA;cAAA;cAAA;YAAA,QADF,eAEE;cAAO,SAAS,EAAC,cAAjB;cAAgC,IAAI,EAAC,MAArC;cAA4C,WAAW,EAAC,kBAAxD;cAA2E,EAAE,EAAC,OAA9E;cAAsF,KAAK,EAAE7E,KAAK,CAACe,KAAnG;cAA0G,QAAQ,EAAEuD,YAApH;cAAkI,QAAQ;YAA1I;cAAA;cAAA;cAAA;YAAA,QAFF;UAAA;YAAA;YAAA;YAAA;UAAA,QAFF,eAME;YAAK,SAAS,EAAC,YAAf;YAAA,wBACE;cAAO,SAAS,EAAC,iBAAjB;cAAA;YAAA;cAAA;cAAA;cAAA;YAAA,QADF,eAEI;cAAO,SAAS,EAAC,cAAjB;cACM,IAAI,EAAC,MADX;cAEM,EAAE,EAAC,OAFT;cAGM,MAAM,EAAC,uBAHb;cAGsC,QAAQ,EAAEK,iBAHhD;cAGmE,QAAQ;YAH3E;cAAA;cAAA;cAAA;YAAA,QAFJ;UAAA;YAAA;YAAA;YAAA;UAAA,QANF,eAaE;YAAK,SAAS,EAAC,YAAf;YAAA,wBACE;cAAA;cAAA;cAAA;YAAA,QADF,eAEE;cAAQ,IAAI,EAAC,QAAb;cAAsB,SAAS,EAAC,iBAAhC;cAAA;YAAA;cAAA;cAAA;cAAA;YAAA,QAFF;UAAA;YAAA;YAAA;YAAA;UAAA,QAbF;QAAA;UAAA;UAAA;UAAA;QAAA;MADF;QAAA;QAAA;QAAA;MAAA;IADF;MAAA;MAAA;MAAA;IAAA,QAJI,eA2BF;MAAK,OAAO,EAAC,MAAb;MAAoB,eAAY,QAAhC;MAAyC,mBAAgB,QAAzD;MAAA,uBAEE;QAAK,GAAG,EAAExE,MAAV;QAAkB,MAAM,EAAC,MAAzB;QAAgC,KAAK,EAAC;MAAtC;QAAA;QAAA;QAAA;MAAA;IAFF;MAAA;MAAA;MAAA;IAAA,QA3BE;EAAA,gBAAR;AAoCD;;GA9PQN,S;UAEYN,W,EACCD,W;;;KAHbO,S;AAgQT,eAAeA,SAAf"},"metadata":{},"sourceType":"module"}